#!/bin/bash

# A script to train the kaggle model locally.

DATE=`date '+%Y%m%d_%H%M%S'`
BUCKET_NAME=annotator_models

declare -a arr=("toxic" "severe_toxic" "obscene" "threat" "insult" "identity_hate")
#declare -a arr=("toxic")

## now loop through the above array
for label in "${arr[@]}"
do
  gcloud ml-engine local train \
     --module-name=trainer.dawid_skene \
     --package-path=trainer -- \
     --data-path=gs://${BUCKET_NAME}/kaggle_annotation_data/dawid_skene_annotations_on_kaggle_combined_${label}.csv \
     --comment-text-path=gs://${BUCKET_NAME}/kaggle_annotation_data/dawid_skene_annotations_on_kaggle_combined_${label}.csv \
     --label=${label} \
     --job-dir='results' \
     --worker-id-col='annotator_id' \
     --unit-id-col='comment_id' \ 
     --tolerance=50
done
